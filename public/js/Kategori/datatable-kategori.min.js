"use strict";
// Data Table Untuk Kategori
$.ajaxSetup({
    headers: {
        'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
    }
});

$(document).ready(function () {
    $("#table-kategori").DataTable({
        columnDefs: [{
            sortable: true,
            targets: [1]
        }],
        lengthChange: true,
        order: [
            [1, "asc"]
        ],
        processing: true,
        serverSide: true,
        orderable: true,
        searchable: true,
        responsive: true,
        ajax: "kategori",
        columns: [{
                data: "DT_RowIndex",
                name: "DT_RowIndex",
                orderable: false,
                searchable: false
            },
            {
                data: "nama_kategori",
                name: "nama_kategori"
            },
            {
                data: "action",
                name: "action",
                orderable: false,
                searchable: false
            }
        ]
    });
});

$(document).on("click", "button.confirmDeleteKategori", function (e) {
    e.preventDefault();
    var id = $(this).attr("data-id");
    Swal.fire({
            title: 'Are you sure?',
            text: "You won't be able to revert this!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Yes, delete it!',
            showClass: {
                popup: 'animated bounceIn faster'
            },
            hideClass: {
                popup: 'animated bounceOut faster'
            }
        })
        .then((result) => {
            if (result.value) {
                $.ajax({
                    url: "kategori/" + id,
                    type: "POST",
                    data: {
                        '_method': 'DELETE'
                    },
                    success: function (data) {
                        Swal.fire({
                                title: data.title,
                                text: data.text,
                                icon: data.icon
                            })
                            .then(() => {
                                location.reload();
                            });
                    },
                    error: function (data) {
                        Swal.fire({
                            title: 'Opps...',
                            text: data.message,
                            type: 'error',
                            timer: '1500'
                        })
                    }
                })
            }
        });
});
// End Data Table Untuk Kategori